<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mini DAW Dashboard</title>
  <link rel="stylesheet" href="/static/app.css"> <!-- Step 5 Custom styles -->
  <script src="/_sdk/element_sdk.js"></script>
  <style>
    body {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: #ffffff;
      color: #1a1a1a;
      overflow: hidden;
      height: 100%;
    }

    html {
      height: 100%;
    }

    * {
      box-sizing: border-box;
    }

    .app-container {
      display: flex;
      height: 100vh;
      width: 100%;
      overflow: hidden;
    }

    /* Progress Bar */
    .progress-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      background: rgba(255, 255, 255, 0.98);
      padding: 16px 24px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
      z-index: 1000;
      display: none;
    }

    .progress-overlay.active {
      display: block;
    }

    .progress-text {
      font-size: 14px;
      font-weight: 600;
      color: #1E5EFF;
      margin-bottom: 8px;
    }

    .progress-bar-bg {
      height: 6px;
      background: #EAF0FF;
      border-radius: 10px;
      overflow: hidden;
    }

    .progress-bar-fill {
      height: 100%;
      background: linear-gradient(90deg, #1E5EFF, #4A7DFF);
      border-radius: 10px;
      transition: width 0.3s ease;
    }

    /* Left Panel - Chat */
    .left-panel {
      width: 320px;
      background: #F5F7FA;
      border-right: 1px solid #E0E4EB;
      display: flex;
      flex-direction: column;
      flex-shrink: 0;
    }

    .project-info {
      padding: 20px;
      background: white;
      border-bottom: 1px solid #E0E4EB;
    }

    .project-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
    }

    .project-title {
      font-size: 16px;
      font-weight: 700;
      color: #1a1a1a;
    }

    .settings-icon {
      width: 32px;
      height: 32px;
      border-radius: 8px;
      background: #F5F7FA;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: background 0.2s;
    }

    .settings-icon:hover {
      background: #EAF0FF;
    }

    .project-meta {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
    }

    .meta-item {
      background: #F5F7FA;
      padding: 10px 12px;
      border-radius: 10px;
    }

    .meta-label {
      font-size: 11px;
      color: #666;
      margin-bottom: 4px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .meta-value {
      font-size: 15px;
      font-weight: 700;
      color: #1E5EFF;
    }

    .chat-container {
      flex: 1;
      overflow-y: auto;
      padding: 16px;
    }

    .chat-message {
      margin-bottom: 12px;
      animation: slideIn 0.3s ease;
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .message-bubble {
      padding: 12px 14px;
      border-radius: 12px;
      max-width: 85%;
      word-wrap: break-word;
    }

    .user-message .message-bubble {
      background: #1E5EFF;
      color: white;
      margin-left: auto;
      border-bottom-right-radius: 4px;
    }

    .ai-message .message-bubble {
      background: white;
      color: #1a1a1a;
      border: 1px solid #E0E4EB;
      border-bottom-left-radius: 4px;
    }

    .message-sender {
      font-size: 11px;
      font-weight: 600;
      margin-bottom: 4px;
      color: #666;
    }

    .user-message .message-sender {
      text-align: right;
    }

    .chat-input-area {
      padding: 16px;
      background: white;
      border-top: 1px solid #E0E4EB;
    }

    .input-wrapper {
      display: flex;
      gap: 8px;
      margin-bottom: 12px;
    }

    .chat-input {
      flex: 1;
      padding: 12px 14px;
      border: 2px solid #E0E4EB;
      border-radius: 10px;
      font-size: 14px;
      font-family: inherit;
      transition: border-color 0.2s;
    }

    .chat-input:focus {
      outline: none;
      border-color: #1E5EFF;
    }

    .button {
      padding: 12px 18px;
      border: none;
      border-radius: 10px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      font-family: inherit;
    }

    .button-primary {
      background: #1E5EFF;
      color: white;
    }

    .button-primary:hover {
      background: #1651E0;
      transform: translateY(-1px);
    }

    .button-secondary {
      background: #F5F7FA;
      color: #1a1a1a;
    }

    .button-secondary:hover {
      background: #EAF0FF;
    }

    .button-actions {
      display: flex;
      gap: 8px;
    }

    .help-text {
      font-size: 11px;
      color: #888;
      margin-top: 8px;
      line-height: 1.5;
    }

    /* Center Panel - Timeline */
    .center-panel {
      flex: 1;
      display: flex;
      flex-direction: column;
      background: white;
      overflow: hidden;
    }

    .transport-bar {
      padding: 16px 24px;
      background: #F5F7FA;
      border-bottom: 1px solid #E0E4EB;
      display: flex;
      align-items: center;
      gap: 16px;
      flex-wrap: wrap;
    }

    .transport-controls {
      display: flex;
      gap: 8px;
    }

    .transport-button {
      width: 40px;
      height: 40px;
      border-radius: 10px;
      border: none;
      background: white;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08);
    }

    .transport-button:hover {
      background: #EAF0FF;
      transform: translateY(-1px);
    }

    .transport-button.active {
      background: #1E5EFF;
      color: white;
    }

    .transport-divider {
      width: 1px;
      height: 32px;
      background: #E0E4EB;
    }

    .transport-input {
      padding: 8px 12px;
      border: 2px solid #E0E4EB;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 600;
      width: 80px;
      font-family: inherit;
    }

    .transport-select {
      padding: 8px 12px;
      border: 2px solid #E0E4EB;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 600;
      background: white;
      cursor: pointer;
      font-family: inherit;
    }

    .swing-control {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .swing-label {
      font-size: 12px;
      font-weight: 600;
      color: #666;
    }

    .swing-slider {
      width: 100px;
      height: 6px;
      border-radius: 10px;
      background: #E0E4EB;
      -webkit-appearance: none;
      appearance: none;
    }

    .swing-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 18px;
      height: 18px;
      border-radius: 50%;
      background: #1E5EFF;
      cursor: pointer;
    }

    .timeline-area {
      flex: 1;
      overflow: auto;
      padding: 24px;
    }

    .timeline-grid {
      position: relative;
      background: white;
      border: 2px solid #E0E4EB;
      border-radius: 14px;
      padding: 20px;
      min-height: 400px;
    }

    .timeline-header {
      display: flex;
      margin-bottom: 16px;
      padding-left: 100px;
    }

    .bar-marker {
      flex: 1;
      text-align: center;
      font-size: 12px;
      font-weight: 700;
      color: #1E5EFF;
      padding: 8px;
      background: #EAF0FF;
      border-radius: 8px;
      margin: 0 2px;
    }

    .timeline-tracks {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .track-row {
      display: flex;
      align-items: center;
      height: 60px;
      position: relative;
    }

    .track-label {
      width: 100px;
      font-size: 13px;
      font-weight: 700;
      color: #1a1a1a;
      padding-right: 12px;
    }

    .track-grid {
      flex: 1;
      height: 100%;
      background: repeating-linear-gradient(
        to right,
        #F5F7FA 0px,
        #F5F7FA 1px,
        transparent 1px,
        transparent calc(100% / 16)
      );
      border: 1px solid #E0E4EB;
      border-radius: 8px;
      position: relative;
    }

    .bar-divider {
      position: absolute;
      top: 0;
      bottom: 0;
      width: 2px;
      background: #1E5EFF;
      opacity: 0.3;
    }

    .beat-marker {
      position: absolute;
      top: -20px;
      font-size: 10px;
      color: #888;
      font-weight: 600;
    }

    .event-block {
      position: absolute;
      height: 80%;
      top: 10%;
      background: linear-gradient(135deg, #1E5EFF, #4A7DFF);
      border-radius: 6px;
      cursor: move;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 20px;
      transition: all 0.2s;
      box-shadow: 0 2px 6px rgba(30, 94, 255, 0.3);
    }

    .event-block:hover {
      transform: scale(1.05);
      box-shadow: 0 4px 12px rgba(30, 94, 255, 0.4);
    }

    .event-block.selected {
      border: 2px solid #1E5EFF;
      box-shadow: 0 0 0 4px rgba(30, 94, 255, 0.2);
    }

    .audio-preview {
      padding: 24px;
      background: #F5F7FA;
      border-top: 1px solid #E0E4EB;
    }

    .waveform-container {
      background: white;
      border: 2px solid #E0E4EB;
      border-radius: 12px;
      padding: 16px;
      margin-bottom: 16px;
      height: 80px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .waveform {
      display: flex;
      align-items: center;
      gap: 2px;
      height: 100%;
    }

    .waveform-bar {
      width: 3px;
      background: #1E5EFF;
      border-radius: 2px;
      opacity: 0.6;
    }

    /* Right Panel - Tracks */
    .right-panel {
      width: 320px;
      background: #F5F7FA;
      border-left: 1px solid #E0E4EB;
      display: flex;
      flex-direction: column;
      overflow-y: auto;
      flex-shrink: 0;
      transition: transform 0.3s ease;
    }

    .right-panel.collapsed {
      transform: translateX(100%);
    }

    .panel-toggle {
      position: absolute;
      right: 320px;
      top: 50%;
      transform: translateY(-50%);
      width: 32px;
      height: 64px;
      background: #1E5EFF;
      border-radius: 10px 0 0 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      color: white;
      font-size: 18px;
      transition: all 0.3s;
      z-index: 10;
    }

    .panel-toggle:hover {
      background: #1651E0;
    }

    .panel-section {
      padding: 20px;
      background: white;
      border-bottom: 1px solid #E0E4EB;
    }

    .section-title {
      font-size: 14px;
      font-weight: 700;
      color: #1a1a1a;
      margin-bottom: 16px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .track-card {
      background: #F5F7FA;
      border: 2px solid #E0E4EB;
      border-radius: 12px;
      padding: 14px;
      margin-bottom: 12px;
      transition: all 0.2s;
    }

    .track-card:hover {
      border-color: #1E5EFF;
      transform: translateX(-2px);
    }

    .track-card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
    }

    .track-name {
      font-size: 14px;
      font-weight: 700;
      color: #1a1a1a;
    }

    .track-buttons {
      display: flex;
      gap: 6px;
    }

    .track-toggle {
      width: 32px;
      height: 28px;
      border-radius: 6px;
      border: none;
      background: white;
      cursor: pointer;
      font-size: 11px;
      font-weight: 700;
      transition: all 0.2s;
    }

    .track-toggle.active {
      background: #1E5EFF;
      color: white;
    }

    .track-control {
      margin-bottom: 10px;
    }

    .control-label {
      font-size: 11px;
      color: #666;
      margin-bottom: 6px;
      font-weight: 600;
      display: flex;
      justify-content: space-between;
    }

    .control-slider {
      width: 100%;
      height: 6px;
      border-radius: 10px;
      background: #E0E4EB;
      -webkit-appearance: none;
      appearance: none;
    }

    .control-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 16px;
      height: 16px;
      border-radius: 50%;
      background: #1E5EFF;
      cursor: pointer;
    }

    .sample-name {
      font-size: 12px;
      color: #888;
      font-style: italic;
      margin-top: 8px;
    }

    .sample-list {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-bottom: 12px;
    }

    .sample-item {
      padding: 10px 12px;
      background: #F5F7FA;
      border: 1px solid #E0E4EB;
      border-radius: 8px;
      font-size: 12px;
      color: #1a1a1a;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .sample-item:hover {
      background: #EAF0FF;
    }

    .chord-controls {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-bottom: 12px;
    }

    .chord-select {
      padding: 10px;
      border: 2px solid #E0E4EB;
      border-radius: 8px;
      font-size: 13px;
      font-weight: 600;
      background: white;
      cursor: pointer;
      font-family: inherit;
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body>
  <div class="app-container"><!-- Progress Overlay -->
   <div class="progress-overlay" id="progressOverlay">
    <div class="progress-text" id="progressText">
     Processing...
    </div>
    <div class="progress-bar-bg">
     <div class="progress-bar-fill" id="progressBar" style="width: 0%"></div>
    </div>
   </div><!-- Left Panel - Chat -->
   <div class="left-panel">
    <div class="project-info">
     <div class="project-header">
      <div class="project-title" id="projectName">
       My Project
      </div>
      <div class="settings-icon" title="Settings">
       <svg width="18" height="18" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3" /> <path d="M12 1v6m0 6v6m8.66-15l-3 5.2M6.34 4L3.34 9.2m17.32 5.6l-5.2 3M8.66 14.8l-5.2 3M23 12h-6m-6 0H1" />
       </svg>
      </div>
     </div>
     <div class="project-meta">
      <div class="meta-item">
       <div class="meta-label">
        Time Sig
       </div>
       <div class="meta-value">
        4/4
       </div>
      </div>
      <div class="meta-item">
       <div class="meta-label">
        BPM
       </div>
       <div class="meta-value">
        120
       </div>
      </div>
      <div class="meta-item">
       <div class="meta-label">
        Bars
       </div>
       <div class="meta-value">
        4
       </div>
      </div>
      <div class="meta-item">
       <div class="meta-label">
        Resolution
       </div>
       <div class="meta-value">
        1/16
       </div>
      </div>
     </div>
    </div>
    <div class="chat-container" id="chatContainer">
     <div class="chat-message ai-message">
      <div class="message-sender">
       AI Assistant
      </div>
      <div class="message-bubble" id="welcomeMessage">
       Start creating music with natural language commands!
      </div>
     </div>
    </div>
    <div class="chat-input-area">
     <div class="input-wrapper"><input type="text" class="chat-input" id="chatInput" placeholder="Type a command..."> <button class="button button-primary" id="sendButton">Send</button>
     </div>
     <div class="button-actions"><button class="button button-secondary" id="undoButton">Undo</button> <button class="button button-primary" id="renderButton">Render Preview</button>
     </div>
     <div class="help-text">
      Try: "Add snare on bar 2, beat 2 &amp;" or "Move bass two steps right"
     </div>
    </div>
   </div><!-- Center Panel - Timeline -->
   <div class="center-panel">
    <div class="transport-bar">
     <div class="transport-controls"><button class="transport-button" id="playButton" title="Play">
       <svg width="20" height="20" viewbox="0 0 24 24" fill="currentColor"><path d="M8 5v14l11-7z" />
       </svg></button> <button class="transport-button" id="stopButton" title="Stop">
       <svg width="20" height="20" viewbox="0 0 24 24" fill="currentColor"><rect x="6" y="6" width="12" height="12" />
       </svg></button> <button class="transport-button" id="loopButton" title="Loop">
       <svg width="20" height="20" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8" /> <path d="M3 3v5h5" /> <path d="M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16" /> <path d="M16 21h5v-5" />
       </svg></button>
     </div>
     <div class="transport-divider"></div><input type="number" class="transport-input" value="120" min="60" max="200" title="BPM"> <select class="transport-select" title="Bars"> <option>2 Bars</option> <option selected>4 Bars</option> <option>8 Bars</option> </select> <select class="transport-select" id="gridSelect" title="Grid"> <option>1/4</option> <option>1/8</option> <option selected>1/16</option> </select>
     <div class="swing-control"><span class="swing-label">Swing</span> <input type="range" class="swing-slider" min="0" max="100" value="50">
     </div>
    </div>
    <div class="timeline-area">
     <div class="timeline-grid">
      <div class="timeline-header">
       <div class="bar-marker">
        Bar 1
       </div>
       <div class="bar-marker">
        Bar 2
       </div>
       <div class="bar-marker">
        Bar 3
       </div>
       <div class="bar-marker">
        Bar 4
       </div>
      </div>
      <div class="timeline-tracks" id="timelineTracks"><!-- Drums Track -->
       <div class="track-row">
        <div class="track-label">
         Drums
        </div>
        <div class="track-grid" data-track="drums">
         <div class="bar-divider" style="left: 25%"></div>
         <div class="bar-divider" style="left: 50%"></div>
         <div class="bar-divider" style="left: 75%"></div><!-- Kick -->
         <div class="event-block" style="left: 0%; width: 6.25%">
          ü•Å
         </div>
         <div class="event-block" style="left: 25%; width: 6.25%">
          ü•Å
         </div>
         <div class="event-block" style="left: 50%; width: 6.25%">
          ü•Å
         </div><!-- Snare -->
         <div class="event-block" style="left: 12.5%; width: 6.25%">
          üîî
         </div>
         <div class="event-block" style="left: 37.5%; width: 6.25%">
          üîî
         </div>
        </div>
       </div><!-- Bass Track -->
       <div class="track-row">
        <div class="track-label">
         Bass
        </div>
        <div class="track-grid" data-track="bass">
         <div class="bar-divider" style="left: 25%"></div>
         <div class="bar-divider" style="left: 50%"></div>
         <div class="bar-divider" style="left: 75%"></div>
         <div class="event-block" style="left: 0%; width: 12.5%">
          ‚ô™
         </div>
         <div class="event-block" style="left: 25%; width: 12.5%">
          ‚ô™
         </div>
         <div class="event-block" style="left: 50%; width: 18.75%">
          ‚ô´
         </div>
        </div>
       </div><!-- Pad Track -->
       <div class="track-row">
        <div class="track-label">
         Pad
        </div>
        <div class="track-grid" data-track="pad">
         <div class="bar-divider" style="left: 25%"></div>
         <div class="bar-divider" style="left: 50%"></div>
         <div class="bar-divider" style="left: 75%"></div>
         <div class="event-block" style="left: 0%; width: 50%">
          „Äú
         </div>
         <div class="event-block" style="left: 50%; width: 50%">
          „Äú
         </div>
        </div>
       </div><!-- Lead Track -->
       <div class="track-row">
        <div class="track-label">
         Lead
        </div>
        <div class="track-grid" data-track="lead">
         <div class="bar-divider" style="left: 25%"></div>
         <div class="bar-divider" style="left: 50%"></div>
         <div class="bar-divider" style="left: 75%"></div>
         <div class="event-block" style="left: 6.25%; width: 6.25%">
          ‚ô¨
         </div>
         <div class="event-block" style="left: 18.75%; width: 6.25%">
          ‚ô¨
         </div>
         <div class="event-block" style="left: 56.25%; width: 12.5%">
          ‚ô¨
         </div>
        </div>
       </div>
      </div>
     </div>
    </div>
    <div class="audio-preview">
     <div class="waveform-container">
      <div class="waveform" id="waveform"></div>
     </div><button class="button button-primary" id="mixdownButton" style="width: 100%"> Download Mixdown </button>
    </div>
   </div><!-- Right Panel - Tracks -->
   <div class="right-panel" id="rightPanel">
    <div class="panel-section">
     <div class="section-title">
      Tracks
     </div>

     <div class="track-card">
      <div class="track-card track-item" data-track="drums">
        <div class="track-card-header">
          <div class="track-name">Drums</div>
          <div class="track-buttons">
            <button class="track-toggle" id="drumsMute">M</button> 
            <button class="track-toggle" id="drumsSolo">S</button>
          </div>
        </div>
      </div>

      <div class="track-control">
       <div class="control-label"><span>Volume</span> <span id="drumsVolValue">75</span>
       </div><input type="range" class="control-slider" id="drumsVol" min="0" max="100" value="75">
      </div>
      <div class="track-control">
       <div class="control-label"><span>Pan</span> <span id="drumsPanValue">C</span>
       </div><input type="range" class="control-slider" id="drumsPan" min="-50" max="50" value="0">
      </div>
      <div class="sample-name">
       Sample: Acoustic Kit 01
      </div>
     </div>
     <div class="track-card">
      <div class="track-card track-item" data-track="bass">
        <div class="track-card-header">
          <div class="track-name">Bass</div>
          <div class="track-buttons">
            <button class="track-toggle" id="bassMute">M</button> 
            <button class="track-toggle" id="bassSolo">S</button>
          </div>
        </div>
      </div>

      <div class="track-control">
       <div class="control-label"><span>Volume</span> <span id="bassVolValue">80</span>
       </div><input type="range" class="control-slider" id="bassVol" min="0" max="100" value="80">
      </div>
      <div class="track-control">
       <div class="control-label"><span>Pan</span> <span id="bassPanValue">C</span>
       </div><input type="range" class="control-slider" id="bassPan" min="-50" max="50" value="0">
      </div>
      <div class="sample-name">
       Sample: Sub Bass 808
      </div>
     </div>

     <div class="track-card">
      <div class="track-card track-item" data-track="pad">
        <div class="track-card-header">
          <div class="track-name">Pad</div>
          <div class="track-buttons">
            <button class="track-toggle" id="padMute">M</button> 
            <button class="track-toggle" id="padSolo">S</button>
          </div>
        </div>
      </div>

      <div class="track-control">
       <div class="control-label"><span>Volume</span> <span id="padVolValue">60</span>
       </div><input type="range" class="control-slider" id="padVol" min="0" max="100" value="60">
      </div>
      <div class="track-control">
       <div class="control-label"><span>Pan</span> <span id="padPanValue">C</span>
       </div><input type="range" class="control-slider" id="padPan" min="-50" max="50" value="0">
      </div>
      <div class="sample-name">
       Sample: Warm Pad A
      </div>
     </div>
     <div class="track-card">
      <div class="track-card track-item" data-track="lead">
        <div class="track-card-header">
          <div class="track-name">Lead</div>
          <div class="track-buttons">
            <button class="track-toggle" id="leadMute">M</button> 
            <button class="track-toggle" id="leadSolo">S</button>
          </div>
        </div>
      </div>

      <div class="track-control">
       <div class="control-label"><span>Volume</span> <span id="leadVolValue">70</span>
       </div><input type="range" class="control-slider" id="leadVol" min="0" max="100" value="70">
      </div>
      <div class="track-control">
       <div class="control-label"><span>Pan</span> <span id="leadPanValue">C</span>
       </div><input type="range" class="control-slider" id="leadPan" min="-50" max="50" value="0">
      </div>
      <div class="sample-name">
       Sample: Pluck Synth C
      </div>
     </div>
    </div>
    <div class="panel-section">
     <div class="section-title">
      Samples
     </div>
     <ul class="sample-list" id="samplesList"></ul>
     <button class="button button-primary" id="generateSample" style="width: 100%"> Generate Sample </button>
    </div>
    <div class="panel-section">
     <div class="section-title">
      Harmony
     </div>
     <div class="chord-controls"><select class="chord-select"> <option>C Major</option> <option selected>A Minor</option> <option>D Minor</option> <option>E Minor</option> </select> <select class="chord-select"> <option>Natural</option> <option selected>Harmonic</option> <option>Melodic</option> </select>
     </div><button class="button button-secondary" style="width: 100%"> Fit to Harmony </button>
    </div>
   </div>
   <div class="panel-toggle" id="panelToggle">
    ‚Ä∫‚Ä∫
   </div>
  </div>
  <script>
    const defaultConfig = {
      project_name: 'My Project',
      welcome_message: 'Start creating music with natural language commands!'
    };

    let config = { ...defaultConfig };

    async function onConfigChange(newConfig) {
      config = { ...newConfig };
      
      const projectNameEl = document.getElementById('projectName');
      if (projectNameEl) {
        projectNameEl.textContent = config.project_name || defaultConfig.project_name;
      }

      const welcomeMessageEl = document.getElementById('welcomeMessage');
      if (welcomeMessageEl) {
        welcomeMessageEl.textContent = config.welcome_message || defaultConfig.welcome_message;
      }
    }

    function mapToCapabilities(config) {
      return {
        recolorables: [],
        borderables: [],
        fontEditable: undefined,
        fontSizeable: undefined
      };
    }

    function mapToEditPanelValues(config) {
      return new Map([
        ['project_name', config.project_name || defaultConfig.project_name],
        ['welcome_message', config.welcome_message || defaultConfig.welcome_message]
      ]);
    }

    if (window.elementSdk) {
      window.elementSdk.init({
        defaultConfig,
        onConfigChange,
        mapToCapabilities,
        mapToEditPanelValues
      });
    }

    // Generate waveform
    const waveform = document.getElementById('waveform');
    for (let i = 0; i < 100; i++) {
      const bar = document.createElement('div');
      bar.className = 'waveform-bar';
      const height = Math.random() * 60 + 20;
      bar.style.height = height + '%';
      waveform.appendChild(bar);
    }

    /* // Chat functionality
    const chatInput = document.getElementById('chatInput');
    const sendButton = document.getElementById('sendButton');
    const chatContainer = document.getElementById('chatContainer');

    function addMessage(text, isUser) {
      const message = document.createElement('div');
      message.className = `chat-message ${isUser ? 'user-message' : 'ai-message'}`;
      message.innerHTML = `
        <div class="message-sender">${isUser ? 'You' : 'AI Assistant'}</div>
        <div class="message-bubble">${text}</div>
      `;
      chatContainer.appendChild(message);
      chatContainer.scrollTop = chatContainer.scrollHeight;
    }

    sendButton.addEventListener('click', () => {
      const text = chatInput.value.trim();
      if (text) {
        addMessage(text, true);
        chatInput.value = '';
        
        setTimeout(() => {
          addMessage('Command received! Processing your request...', false);
        }, 500);
      }
    }); 

    chatInput.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') {
        sendButton.click();
      }
    }); */

    // Transport controls
    const playButton = document.getElementById('playButton');
    const stopButton = document.getElementById('stopButton');
    const loopButton = document.getElementById('loopButton');

    playButton.addEventListener('click', () => {
      playButton.classList.toggle('active');
      if (playButton.classList.contains('active')) {
        playButton.innerHTML = '<svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><rect x="6" y="4" width="4" height="16"/><rect x="14" y="4" width="4" height="16"/></svg>';
      } else {
        playButton.innerHTML = '<svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M8 5v14l11-7z"/></svg>';
      }
    });

    loopButton.addEventListener('click', () => {
      loopButton.classList.toggle('active');
    });

    // Progress simulation
    function showProgress(text, duration) {
      const overlay = document.getElementById('progressOverlay');
      const progressText = document.getElementById('progressText');
      const progressBar = document.getElementById('progressBar');
      
      progressText.textContent = text;
      overlay.classList.add('active');
      
      let progress = 0;
      const interval = setInterval(() => {
        progress += 2;
        progressBar.style.width = progress + '%';
        progressText.textContent = `${text} ${progress}%`;
        
        if (progress >= 100) {
          clearInterval(interval);
          setTimeout(() => {
            overlay.classList.remove('active');
            progressBar.style.width = '0%';
          }, 500);
        }
      }, duration / 50);
    }

    document.getElementById('renderButton').addEventListener('click', () => {
      showProgress('Rendering Preview...', 3000);
    });

    document.getElementById('mixdownButton').addEventListener('click', () => {
      showProgress('Generating Mixdown...', 4000);
    });

    document.getElementById('generateSample').addEventListener('click', () => {
      showProgress('Generating Sample...', 2500);
    });

    // Panel toggle
    const panelToggle = document.getElementById('panelToggle');
    const rightPanel = document.getElementById('rightPanel');

    panelToggle.addEventListener('click', () => {
      rightPanel.classList.toggle('collapsed');
      panelToggle.textContent = rightPanel.classList.contains('collapsed') ? '‚Äπ‚Äπ' : '‚Ä∫‚Ä∫';
    });

    // Volume sliders
    ['drums', 'bass', 'pad', 'lead'].forEach(track => {
      const volSlider = document.getElementById(`${track}Vol`);
      const volValue = document.getElementById(`${track}VolValue`);
      const panSlider = document.getElementById(`${track}Pan`);
      const panValue = document.getElementById(`${track}PanValue`);

      volSlider.addEventListener('input', (e) => {
        volValue.textContent = e.target.value;
      });

      panSlider.addEventListener('input', (e) => {
        const val = parseInt(e.target.value);
        if (val === 0) panValue.textContent = 'C';
        else if (val < 0) panValue.textContent = `L${Math.abs(val)}`;
        else panValue.textContent = `R${val}`;
      });

      // Mute/Solo buttons
      const muteBtn = document.getElementById(`${track}Mute`);
      const soloBtn = document.getElementById(`${track}Solo`);

      muteBtn.addEventListener('click', () => {
        muteBtn.classList.toggle('active');
      });

      soloBtn.addEventListener('click', () => {
        soloBtn.classList.toggle('active');
      });
    });

    // Event block interactions
    document.querySelectorAll('.event-block').forEach(block => {
      block.addEventListener('click', () => {
        document.querySelectorAll('.event-block').forEach(b => b.classList.remove('selected'));
        block.classList.add('selected');
      });
    });
  </script>
  <script src="/static/app.js"></script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9ae3ecfba55c322a',t:'MTc2NTc4MDU3Ny4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script>
 </body>
 </html>